package com.zerra.common.util;

import java.lang.management.ManagementFactory;

import javax.management.Attribute;
import javax.management.AttributeList;
import javax.management.MBeanServer;
import javax.management.ObjectName;

public class SystemInfo
{

	public static long getMaxMemory()
	{
		return Runtime.getRuntime().maxMemory();
	}

	public static long getUsedMemory()
	{
		return getMaxMemory() - getFreeMemory();
	}

	public static long getTotalMemory()
	{
		return Runtime.getRuntime().totalMemory();
	}

	public static long getFreeMemory()
	{
		return Runtime.getRuntime().freeMemory();
	}

	public static double getProcessCpuLoad()
	{
		try
		{
			MBeanServer mbs = ManagementFactory.getPlatformMBeanServer();
			ObjectName name = ObjectName.getInstance("java.lang:type=OperatingSystem");
			AttributeList list = mbs.getAttributes(name, new String[]
			{ "ProcessCpuLoad" });

			if (list.isEmpty())
				return Double.NaN;

			Attribute att = (Attribute) list.get(0);
			Double value = (Double) att.getValue();

			// usually takes a couple of seconds before we get real values
			if (value == -1.0)
				return Double.NaN;
			// returns a percentage value with 1 decimal point precision
			return ((int) (value * 1000) / 10.0);

		} catch (Exception e)
		{
			e.printStackTrace();
			return 0D;
		}
	}
}
